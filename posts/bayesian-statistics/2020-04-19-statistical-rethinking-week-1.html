<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">
<meta name="dcterms.date" content="2020-04-19">

<title>David Salazar - Statistical Rethinking: Week 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">David Salazar</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../archive.html">
 <span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/David-Salazar"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/DavidSalazarVir"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Statistical Rethinking: Week 1</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 19, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#week-1" id="toc-week-1" class="nav-link active" data-scroll-target="#week-1">Week 1</a>
  <ul class="collapse">
  <li><a href="#practice-from-chapter-3" id="toc-practice-from-chapter-3" class="nav-link" data-scroll-target="#practice-from-chapter-3">Practice from Chapter 3</a>
  <ul class="collapse">
  <li><a href="#easy" id="toc-easy" class="nav-link" data-scroll-target="#easy">Easy</a></li>
  <li><a href="#medium" id="toc-medium" class="nav-link" data-scroll-target="#medium">Medium</a></li>
  </ul></li>
  <li><a href="#hard" id="toc-hard" class="nav-link" data-scroll-target="#hard">Hard</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="week-1" class="level1">
<h1>Week 1</h1>
<p>Week 1 tries to go as deep as possible in the intuition and the mechanics of a very simple model. As always with McElreath, he goes on with both clarity and erudition.</p>
<blockquote class="blockquote">
<p>Suppose the globe tossing data had turned out to be 8 water in 15 tosses. Construct the posterior distribution, using grid approximation. Use the same flat prior as before.</p>
</blockquote>
<div class="cell">
<div class="cell-output-display">
<p><img src="2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5288668</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Start over in 1, but now use a prior that is zero below p = 0.5 and a constant above p = 0.5. This corresponds to prior information that a majority of the Earth’s surface is water. What difference does the better prior make? If it helps, compare posterior distributions (using both priors) to the true value p = 0.7.</p>
</blockquote>
<div class="cell">
<div class="cell-output-display">
<p><img src="2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>By rejecting altogether from the beginning the possibility of having less than the half of the world covered with water, the model with the new prior piles on more plausibility on the values closer to the true value. Thus, the more informative prior helps our inference.</p>
<blockquote class="blockquote">
<p>This problem is more open-ended than the others. Feel free to collaborate on the solution. Suppose you want to estimate the Earth’s proportion of water very precisely. Specifically, you want the 99% percentile interval of the posterior distribution of p to be only 0.05 wide. This means the distance between the upper and lower bound of the interval should be 0.05. How many times will you have to toss the globe to do this? I won’t require a precise answer. I’m honestly more interested in your approach.</p>
</blockquote>
<section id="practice-from-chapter-3" class="level2">
<h2 class="anchored" data-anchor-id="practice-from-chapter-3">Practice from Chapter 3</h2>
<section id="easy" class="level3">
<h3 class="anchored" data-anchor-id="easy">Easy</h3>
<div class="cell">

</div>
<blockquote class="blockquote">
<p>How much posterior probability lies below p = 0.2?</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>The probability below p = 0.2 is 0.1%</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>How much posterior probability lies above p = 0.8?</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>The probability above p = 0.8 is 9.1%</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>How much posterior probability lies between p = 0.2 and p = 0.8</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>The probability is 90.8%</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>20% of the posterior probability lies below which value of p?</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      20% 
0.5163163 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>20% of the posterior probability lies above which value of p?</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      80% 
0.7427427 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Which values of p contain the narrowest interval equal to 66% of the posterior probability?</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    |0.66     0.66| 
0.5135135 0.7697698 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Which values of p containt 66% of the posterior probability, assuming equal posterior probability both below and above the interval?</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      17%       83% 
0.4961562 0.7569269 </code></pre>
</div>
</div>
</section>
<section id="medium" class="level3">
<h3 class="anchored" data-anchor-id="medium">Medium</h3>
<div class="cell">

</div>
<blockquote class="blockquote">
<p>HPDI 90% for p</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     |0.9      0.9| 
0.3343343 0.7217217 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Posterior predictive check. 8 tosses in 15, prediction averaged over our posterior distribution.</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1499</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Using the posterior distribution contracted from the 8/15 data, now calculate the probability of observing 6 water in 9 tosses.</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1842</code></pre>
</div>
</div>
<section id="different-prior" class="level4">
<h4 class="anchored" data-anchor-id="different-prior">Different prior</h4>
<div class="cell">

</div>
<blockquote class="blockquote">
<p>HPDI 90% for p</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     |0.9      0.9| 
0.5005005 0.7097097 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Posterior predictive check. 8 tosses in 15, prediction averaged over our posterior distribution.</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.163</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Using the posterior distribution contracted from the 8/15 data, now calculate the probability of observing 6 water in 9 tosses.</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2353</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Number of tosses have a 99% percentile interval to be only 0.05 wide.</p>
</blockquote>
<p>We know the true value of our problem: <span class="math inline">\(p = 0.7\)</span>. We will simulate data for many Ns and find out how precisely we can estimate the interval for each of these values. We will repeat these simulations for each value of N 100 times. Then, we plot the different bounds that we get.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It seems we would have to toss the worldarround 2000 times to get a bound close to 0.05. The marginal benefit that we get, in terms of tighting our estimated bound, decreases as we toss more and more. The greates benefits of increasing the data seem to be at the beginning.</p>
</section>
</section>
</section>
<section id="hard" class="level2">
<h2 class="anchored" data-anchor-id="hard">Hard</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1 0 0 0 1 1 0 1 0 1 0 0 1 1 0 1 1 0 0 0 1 0 0 0 1 0 0 0 0 1 1 1 0 1 0 1 1
 [38] 1 0 1 0 1 1 0 1 0 0 1 1 0 1 0 0 0 0 0 0 0 1 1 0 1 0 0 1 0 0 0 1 0 0 1 1 1
 [75] 1 0 1 0 1 1 1 1 1 0 0 1 0 1 1 0 1 0 1 1 1 0 1 1 1 1</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0 1 0 1 0 1 1 1 0 0 1 1 1 1 1 0 0 1 1 1 0 0 1 1 1 0 1 1 1 0 1 1 1 0 1 0 0
 [38] 1 1 1 1 0 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 0 1 1 1 0 0 0
 [75] 0 0 0 1 0 0 0 1 1 0 0 1 0 0 1 1 0 0 0 1 1 1 0 0 0 0</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Using grid approximation, compute the posterior distribution for the probability of a birth being a boy. Assume a uniform probability…</p>
</blockquote>
<p>So, set up a binomial likelihood with <span class="math inline">\(n, k\)</span>:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 200 111</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Maximum posterior probability is obtained at 0.56</code></pre>
</div>
</div>
<p>A logical answer, considering the slight majority of boys at the sample.</p>
<blockquote class="blockquote">
<p>Draw 10000 random samples from the posterior distribution… HPDI for 50%, 89%, and 97%</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    |0.97     |0.89      |0.5      0.5|     0.89|     0.97| 
0.4848485 0.5050505 0.5454545 0.5858586 0.6060606 0.6262626 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Check that the model’s implied predictions fit the actual count</p>
</blockquote>
<div class="cell">
<div class="cell-output-display">
<p><img src="2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Now compare 10,000 counts of boys from 100 simulated first borns only to the number of boys in the first births. How does the model look in this light</p>
</blockquote>
<div class="cell">
<div class="cell-output-display">
<p><img src="2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now the model seems to be underperforming. It’s implied prediction for 100 boys is way larger thatn the actual observed value.</p>
<blockquote class="blockquote">
<p>The model assumes that sex of first and second births are independent. Validate this assumption.</p>
</blockquote>
<p>If the sex of first and second births are independent, after condintioning on the first being a girl, the probability of being a boy should be the same as in the whole sample. Let’s predict with our model conditioning on the boy having an older sister.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Our model only assumes a 0.06% to the observed value</code></pre>
</div>
</div>
<p>The model under predicts the number of boys that have older sisters. It seems that, in our sample, the sex of the first and second births are not independent. It may be that our sample is biased. Or maybe people keep having babies until they have a boy. Who knows, right?</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>