{
  "hash": "5548ef600c955c318677f6effc7e38d6",
  "result": {
    "markdown": "---\ntitle: 'Statistical Rethinking: Week 1'\nauthor: ''\ndate: '2020-04-19'\nslug: statistical-rethinking-week-1\ncategories: []\ntags: []\n---\n\n\n\n\n# Week 1\n\nWeek 1 tries to go as deep as possible in the intuition and the mechanics of a very simple model. As always with McElreath, he goes on with both clarity and erudition.\n\n> Suppose the globe tossing data had turned out to be 8 water in 15 tosses.\nConstruct the posterior distribution, using grid approximation. Use the\nsame flat prior as before.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5288668\n```\n:::\n:::\n\n\n\n> Start over in 1, but now use a prior that is zero below p = 0.5 and a constant above p = 0.5. This corresponds to prior information that a majority\nof the Earth’s surface is water. What difference does the better prior make?\nIf it helps, compare posterior distributions (using both priors) to the true\nvalue p = 0.7.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nBy rejecting altogether from the beginning the possibility of having less than the half of the world covered with water, the model with the new prior piles on more plausibility on the values closer to the true value. Thus, the more informative prior helps our inference. \n\n> This problem is more open-ended than the others. Feel free to collaborate on the solution. Suppose you want to estimate the Earth’s proportion of\nwater very precisely. Specifically, you want the 99% percentile interval of the\nposterior distribution of p to be only 0.05 wide. This means the distance between the upper and lower bound of the interval should be 0.05. How many\ntimes will you have to toss the globe to do this? I won’t require a precise\nanswer. I’m honestly more interested in your approach.\n\n## Practice from Chapter 3\n\n### Easy\n\n\n::: {.cell}\n\n:::\n\n\n> How much posterior probability lies below p = 0.2?\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nThe probability below p = 0.2 is 0.1%\n```\n:::\n:::\n\n\n> How much posterior probability lies above p = 0.8?\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nThe probability above p = 0.8 is 9.1%\n```\n:::\n:::\n\n\n> How much posterior probability lies between p = 0.2 and p = 0.8\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nThe probability is 90.8%\n```\n:::\n:::\n\n\n> 20% of the posterior probability lies below which value of p?\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n      20% \n0.5163163 \n```\n:::\n:::\n\n\n> 20% of the posterior probability lies above which value of p?\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n      80% \n0.7427427 \n```\n:::\n:::\n\n\n> Which values of p contain the narrowest interval equal to 66% of the posterior probability?\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n    |0.66     0.66| \n0.5135135 0.7697698 \n```\n:::\n:::\n\n\n> Which values of p containt 66% of the posterior probability, assuming equal posterior probability both below and above the interval?\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n      17%       83% \n0.4961562 0.7569269 \n```\n:::\n:::\n\n\n### Medium\n\n\n::: {.cell}\n\n:::\n\n\n> HPDI 90% for p\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n     |0.9      0.9| \n0.3343343 0.7217217 \n```\n:::\n:::\n\n\n> Posterior predictive check. 8 tosses in 15, prediction averaged over our posterior distribution.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1499\n```\n:::\n:::\n\n \n> Using the posterior distribution contracted from the 8/15 data, now calculate the probability of observing 6 water in 9 tosses.  \n \n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1842\n```\n:::\n:::\n\n\n#### Different prior\n\n\n::: {.cell}\n\n:::\n\n\n> HPDI 90% for p\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n     |0.9      0.9| \n0.5005005 0.7097097 \n```\n:::\n:::\n\n\n> Posterior predictive check. 8 tosses in 15, prediction averaged over our posterior distribution.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.163\n```\n:::\n:::\n\n \n> Using the posterior distribution contracted from the 8/15 data, now calculate the probability of observing 6 water in 9 tosses.  \n \n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2353\n```\n:::\n:::\n\n\n> Number of tosses have a 99% percentile interval to be only 0.05 wide. \n\nWe know the true value of our problem: $p = 0.7$. We will simulate data for many Ns and find out how precisely we can estimate the interval for each of these values. We will repeat these simulations for each value of N 100 times. Then, we plot the different bounds that we get. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\nIt seems we would have to toss the worldarround 2000 times to get a bound close to 0.05. The marginal benefit that we get, in terms of tighting our estimated bound, decreases as we toss more and more. The greates benefits of increasing the data seem to be at the beginning. \n\n\n## Hard \n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n  [1] 1 0 0 0 1 1 0 1 0 1 0 0 1 1 0 1 1 0 0 0 1 0 0 0 1 0 0 0 0 1 1 1 0 1 0 1 1\n [38] 1 0 1 0 1 1 0 1 0 0 1 1 0 1 0 0 0 0 0 0 0 1 1 0 1 0 0 1 0 0 0 1 0 0 1 1 1\n [75] 1 0 1 0 1 1 1 1 1 0 0 1 0 1 1 0 1 0 1 1 1 0 1 1 1 1\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n  [1] 0 1 0 1 0 1 1 1 0 0 1 1 1 1 1 0 0 1 1 1 0 0 1 1 1 0 1 1 1 0 1 1 1 0 1 0 0\n [38] 1 1 1 1 0 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 0 1 1 1 0 0 0\n [75] 0 0 0 1 0 0 0 1 1 0 0 1 0 0 1 1 0 0 0 1 1 1 0 0 0 0\n```\n:::\n:::\n\n\n> Using grid approximation, compute the posterior distribution for the probability of a birth being a boy. Assume a uniform probability...\n\n\nSo, set up a binomial likelihood with $n, k$: \n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 200 111\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nMaximum posterior probability is obtained at 0.56\n```\n:::\n:::\n\n\nA logical answer, considering the slight majority of boys at the sample. \n\n> Draw 10000 random samples from the posterior distribution... HPDI for 50%, 89%, and 97%\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n    |0.97     |0.89      |0.5      0.5|     0.89|     0.97| \n0.4848485 0.5050505 0.5454545 0.5858586 0.6060606 0.6262626 \n```\n:::\n:::\n\n\n> Check that the model's implied predictions fit the actual count\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n> Now compare 10,000 counts of boys from 100 simulated first borns only to the number of boys in the first births. How does the model look in this light\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\nNow the model seems to be underperforming. It's implied prediction for 100 boys is way larger thatn the actual observed value. \n\n> The model assumes that sex of first and second births are independent. Validate this assumption. \n\nIf the sex of first and second births are independent, after condintioning on the first being a girl, the probability of being a boy should be the same as in the whole sample. Let's predict with our model conditioning on the boy having an older sister. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2020-04-19-statistical-rethinking-week-1_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nOur model only assumes a 0.06% to the observed value\n```\n:::\n:::\n\n\nThe model under predicts the number of boys that have older sisters. It seems that, in our sample, the sex of the first and second births are not independent. It may be that our sample is biased. Or maybe people keep having babies until they have a boy. Who knows, right?\n\n\n",
    "supporting": [
      "2020-04-19-statistical-rethinking-week-1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}