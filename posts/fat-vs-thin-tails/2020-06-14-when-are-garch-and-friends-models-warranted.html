<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">
<meta name="dcterms.date" content="2020-06-14">

<title>David Salazar - When are GARCH (and friends) models warranted?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">David Salazar</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../archive.html">
 <span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/David-Salazar"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/DavidSalazarVir"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">When are GARCH (and friends) models warranted?</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 14, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-are-the-obstacles" id="toc-what-are-the-obstacles" class="nav-link active" data-scroll-target="#what-are-the-obstacles">What are the obstacles?</a></li>
  <li><a href="#are-the-conditions-satistified-for-the-sp-500" id="toc-are-the-conditions-satistified-for-the-sp-500" class="nav-link" data-scroll-target="#are-the-conditions-satistified-for-the-sp-500">Are the conditions satistified for the S&amp;P 500?</a></li>
  <li><a href="#zipf-plot" id="toc-zipf-plot" class="nav-link" data-scroll-target="#zipf-plot">Zipf Plot</a></li>
  <li><a href="#mean-excess-plots" id="toc-mean-excess-plots" class="nav-link" data-scroll-target="#mean-excess-plots">Mean excess plots</a></li>
  <li><a href="#max-to-sum-ratios" id="toc-max-to-sum-ratios" class="nav-link" data-scroll-target="#max-to-sum-ratios">Max-to-Sum Ratios</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>In this blogpost, I’ll answer the question, following Nassim Taleb’s latest <a href="https://www.researchers.one/media/documents/260-m-Technical%20Incerto%20Vol%201.pdf">technical book: Statistical Consequences of Fat Tails</a>, <strong>when can we use GARCH (and firends) models?</strong> As an example, also following Taleb, I’ll check the resulting conditions with the S&amp;P500.</p>
<section id="what-are-the-obstacles" class="level2">
<h2 class="anchored" data-anchor-id="what-are-the-obstacles">What are the obstacles?</h2>
<p>The Generalized Autoregressive Conditional Heteroskedasticity (GARCH) family of models attempt to model a given time series by exploiting “volatility” clustering (i.e., for some periods volatility is consistently high, for other periods is consistently low). When is this warranted?</p>
<ol type="1">
<li>The theoretical variance <em>must</em> exist.</li>
<li>We must be able to <em>reliably</em> estimate the variance <strong>with the amount of data we have</strong>.</li>
</ol>
<p>Of course, neither of the conditions may be satisfied with fat-tailed data. For example, the theoretical mean <em>may exist</em> but <a href="2020-04-17-fat-vs-thin-does-lln-work.Rmd">the sample mean estimator</a> may suffer from <strong>persistent small-sample effect</strong>: the Law of Large Numbers (LLN) just works <em>way too slowly</em>. Thus, we <strong>cannot reliably</strong> estimate the mean.</p>
<p>The exact <em>same thing</em> happens for the variance, just that the problem compounds: higher moments are more fat-tailed than the original random variable and <a href="2020-06-02-lln-for-higher-p-moments.html">thus the LLN works even more slowly</a>. That is, the theoretical variance <em>may exist</em> but it may be <strong>impossible to estimate it</strong> with the amount of data we have. A heuristic to know the reliability of the sample variance is the existence of the third and fourth moment. As Taleb says:</p>
<blockquote class="blockquote">
<p>In a situation of infinite third moment, the observed second moment will fail to be informative as it will almost never converge to its value</p>
</blockquote>
<p><strong>That is, belonging to the class of Power Law tails with (<span class="math inline">\(\alpha \leq 4\)</span>) cancels the use of the sample variance in any method</strong></p>
</section>
<section id="are-the-conditions-satistified-for-the-sp-500" class="level2">
<h2 class="anchored" data-anchor-id="are-the-conditions-satistified-for-the-sp-500">Are the conditions satistified for the S&amp;P 500?</h2>
<p>Therefore, we could possibly attempt to model the S&amp;P 500’s returns if:</p>
<ol type="1">
<li>The theoretical variance exists</li>
<li>The LLN works fast enough for the variance: i.e., the fourth moment is finite.</li>
</ol>
<p>Both conditions relate to the fat-tailedness of the returns. If they are fat-tailed, how fat-tailed are them? Could we justify positing an <span class="math inline">\(\alpha &gt; 4\)</span>? Following Taleb’s explanation, I’ll conduct a battery of tests to diagnose exactly how fat-tailed the returns are and what may be the tail exponent of their tail.</p>
<p>I’ll use all the available data from 1948 to the present day</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"^GSPC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tq_get</span>(<span class="at">from =</span> <span class="st">"1948-01-09"</span>) <span class="ot">-&gt;</span> sp_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="zipf-plot" class="level2">
<h2 class="anchored" data-anchor-id="zipf-plot">Zipf Plot</h2>
<p><a href="2020-05-19-understanding-the-tail-exponent.html">The Zipf-plot</a>, or the log-log plot, is a great way to diagnose if the tails of a distribution decay as a Power Law. For Power Laws, we expect a linear decay at the tail and a variation of several order of magnitudes in the x-axis. The zipf plot for the absolute daily returns of the S&amp;P is thus:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="2020-06-14-when-are-garch-and-friends-models-warranted_files/figure-html/zipf-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Indeed, we see a linear decay of the tail and a variation of several orders of magnitude in the x-axis. Both signs of fat-tailedness for the day returns.</p>
</section>
<section id="mean-excess-plots" class="level2">
<h2 class="anchored" data-anchor-id="mean-excess-plots">Mean excess plots</h2>
<p>Mean excess plots are also a test of fat-tailedness. For a given threshold <span class="math inline">\(v\)</span>, they estimate:</p>
<p><span class="math display">\[ E[X - v | X &gt; v] \]</span></p>
<p>That is, how the conditional expectation increases as the threshold increases. For a power-law, we expect a linear increase:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="2020-06-14-when-are-garch-and-friends-models-warranted_files/figure-html/me-excess-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="max-to-sum-ratios" class="level2">
<h2 class="anchored" data-anchor-id="max-to-sum-ratios">Max-to-Sum Ratios</h2>
<p>Max-to-Sum ratio plots are a way to check the existence of higher moments. If a given moment exists, the ratio of the max-to-sum should eventually converge to zero:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="2020-06-14-when-are-garch-and-friends-models-warranted_files/figure-html/max-to-sum-1.gif" class="img-fluid"></p>
</div>
</div>
<p>Indeed, neither the third nor the fourth moment seem to converge. No Gaussian variable would ever behave like this: a single discontinuous jump in the ratio allows us to deny it. Indeed, the returns clearly follow a power-law in the tail that <strong>curbs any convergence for both the skeweness and the kurtosis</strong>. Thus, we can say that the tail follows a power law around <span class="math inline">\(\alpha \approx 3\)</span>.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The tails of the daily returns behave like a power law. Thus, the tails wag the dog, as Taleb says. Given the data, only the first two moments seem to converge. Neither the third nor fourth converge. Thus, we posit a power law of around 3 to describe the tails of the daily returns. This power law is so fat-tailed, that it is just not possible to use the sample variance estimate with the amount of available data. <strong>Therefore, the use of any model that tries to estimate the variance of the daily returns is not warranted.</strong></p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>